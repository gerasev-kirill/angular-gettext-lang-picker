(function(){var a=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};angular.module("ui.gettext.langPicker",["uiFlag","ui.bootstrap","ui.router"]).config(["$provide",function(a){return a.decorator("$state",["$delegate","$langPickerConf",function(a,b){var c,d;return d=a,d.baseGo=d.go,c=function(a,c,d){return c.lang=b.currentLang,this.baseGo(a,c,d)},d.go=c,a}])}]).service("$langPickerConf",["gettextCatalog","$location",function(b,c){return this.languageList=[],this.currentLang="",this._remote_url="",this._lang_loaded=[],this.setCurrentLanguage=function(d){return function(e){var f,g,h,i,j,k;if(a.call(Object.keys(d.languageList),e)<0)throw g=Object.keys(d.languageList),{message:"Unknown lang '"+e+"'. Allowed are:  '"+g.join(", ")+"'."};return d.currentLang=e,a.call(d._lang_loaded,e)<0&&(b.loadRemote(d._remote_url+e+".json"),d._lang_loaded.push(e)),b.setCurrentLanguage(e),i=window.location.pathname,f=window.location.hash,h=i.split("/"),h[1]!==e&&(j=h[1],a.call(d._lang_loaded,j)<0)?h.splice(1,0,e):(k=h[1],a.call(d._lang_loaded,k)>=0&&(h[1]=e)),i=h.join("/"),"/"===i[i.length-1]&&(i=i.substring(0,i.length-1)),history.replaceState("","",i+f),c.path(i+f)}}(this),this.setLanguageList=function(a){return function(b){return a.languageList=angular.copy(b)}}(this),this.setLanguageRemoteUrl=function(a){return function(b){return a._remote_url=angular.copy(b)}}(this),this.getCurrentLanguageName=function(b){return function(){var c;return c=b.currentLang,a.call(Object.keys(b.languageList),c)<0?"":b.languageList[b.currentLang]}}(this),this.detectLanguage=function(b){return function(){var c,d,e,f,g,h,i;if(g=window.location.pathname,f=g.split("/"),""!==f[1]&&(h=f[1],a.call(Object.keys(b.languageList),h)>=0))return void b.setCurrentLanguage(f[1]);for(i=navigator.languages,c=0,e=i.length;e>c;c++)if(d=i[c],d=d.split("-")[0],a.call(Object.keys(b.languageList),d)>=0){b.setCurrentLanguage(d);break}}}(this),this}]).directive("langPicker",["$langPickerConf",function(a){return{restrict:"E",scope:{"default":"=?",ngDisabled:"=?"},controller:["$scope",function(b){return b.$langPickerConf=a,b["default"]?a.setCurrentLanguage(b["default"]):a.detectLanguage(),b.countryFlagCode=function(a){return"en"===a?"gb":a}}],template:'<div uib-dropdown="uib-dropdown" class="btn-group"><button type="button" uib-dropdown-toggle="uib-dropdown-toggle" ng-disabled="ngDisabled" class="btn btn-default"><flag country="{{countryFlagCode($langPickerConf.currentLang)}}"></flag>{{$langPickerConf.getCurrentLanguageName() || \'Language\'}}<span style="margin-left:3px;" class="caret"></span></button><ul uib-dropdown-menu="" role="menu"><li role="menuitem" ng-repeat="(lang_code, lang_name) in $langPickerConf.languageList" ng-click="$langPickerConf.setCurrentLanguage(lang_code)"><a href="javascript: void 0">   <flag country="{{countryFlagCode(lang_code)}}"></flag>{{lang_name}}</a><a href="/{{lang_code}}" style="display:none;"># For google search</a></li></ul></div>'}}])}).call(this);