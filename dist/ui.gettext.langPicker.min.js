(function(){var a=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};angular.module("ui.gettext.langPicker",["uiFlag","ui.bootstrap","ui.router"]).config(["$provide",function(a){return a.decorator("$state",["$delegate","$langPickerConf",function(a,b){var c,d;return d=a,d.baseGo=d.go,c=function(a,c,d){return c=c||{},c.lang=b.currentLang,this.baseGo(a,c,d)},d.go=c,a}])}]).service("$langPickerConf",["gettextCatalog","$injector",function(b,c){return this.languageList=[],this.currentLang="",this._remote_url="",this._lang_loaded=[],this.setCurrentLanguage=function(d){return function(e){var f,g,h,i,j,k,l,m,n,o;if(a.call(Object.keys(d.languageList),e)<0)throw j=Object.keys(d.languageList),{message:"Unknown lang '"+e+"'. Allowed are:  '"+j.join(", ")+"'."};d.currentLang=e,window.currentLang=e,a.call(d._lang_loaded,e)<0&&(b.loadRemote(d._remote_url+e+".json"),d._lang_loaded.push(e)),b.setCurrentLanguage(e);try{return g=c.get("$state"),k=g.params||{},k.lang=e,g.go(g.current.name,k,{notify:!1,reload:!1})}catch(p){return h=p,f=c.get("$location"),m=window.location.pathname,i=window.location.hash,l=m.split("/"),l[1]!==e&&(n=l[1],a.call(d._lang_loaded,n)<0)?l.splice(1,0,e):(o=l[1],a.call(d._lang_loaded,o)>=0&&(l[1]=e)),m=l.join("/"),"/"===m[m.length-1]&&(m=m.substring(0,m.length-1)),history.replaceState("","",m+i),f.path(m+i)}}}(this),this.setLanguageList=function(a){return function(b){return a.languageList=angular.copy(b)}}(this),this.setLanguageRemoteUrl=function(a){return function(b){return a._remote_url=angular.copy(b)}}(this),this.getCurrentLanguageName=function(b){return function(){var c;return c=b.currentLang,a.call(Object.keys(b.languageList),c)<0?"":b.languageList[b.currentLang]}}(this),this.detectLanguage=function(b){return function(){var c,d,e,f,g,h,i;if(h=window.location.pathname,g=h.split("/"),""!==g[1]&&(i=g[1],a.call(Object.keys(b.languageList),i)>=0))return void b.setCurrentLanguage(g[1]);for(e=window.navigator.languages||[window.navigator.language||window.navigator.userLanguage],c=0,f=e.length;f>c;c++)if(d=e[c],d=d.split("-")[0],a.call(Object.keys(b.languageList),d)>=0){b.setCurrentLanguage(d);break}}}(this),this}]).directive("langPicker",["$langPickerConf",function(a){return{restrict:"E",scope:{"default":"=?",ngDisabled:"=?"},controller:["$scope",function(b){return b.$langPickerConf=a,b["default"]?a.setCurrentLanguage(b["default"]):a.detectLanguage(),b.countryFlagCode=function(a){return"en"===a?"gb":a}}],template:'<div uib-dropdown="uib-dropdown" class="btn-group"><button type="button" uib-dropdown-toggle="uib-dropdown-toggle" ng-disabled="ngDisabled" class="btn btn-default"><flag country="{{countryFlagCode($langPickerConf.currentLang)}}"></flag>{{$langPickerConf.getCurrentLanguageName() || \'Language\'}}<span style="margin-left:3px;" class="caret"></span></button><ul uib-dropdown-menu="" role="menu"><li role="menuitem" ng-repeat="(lang_code, lang_name) in $langPickerConf.languageList" ng-click="$langPickerConf.setCurrentLanguage(lang_code)" ng-class="{\'active\': lang_code==$langPickerConf.currentLang}"><a href="javascript: void 0">   <flag country="{{countryFlagCode(lang_code)}}"></flag>{{lang_name}}</a></li></ul></div>'}}])}).call(this);