(function(){var a=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};angular.module("ui.gettext.langPicker",["uiFlag","ui.bootstrap","ui.router"]).config(["$provide",function(a){return a.decorator("$state",["$delegate","$langPickerConf",function(a,b){var c,d;return d=a,d.baseGo=d.go,c=function(a,c,d){return c=c||{},c.lang=b.currentLang,this.baseGo(a,c,d)},d.go=c,a}])}]).service("$langPickerConf",["gettextCatalog","$location",function(b,c){return this.languageList=[],this.currentLang="",this._remote_url="",this._lang_loaded=[],this.setCurrentLanguage=function(c){return function(d){var e,f,g,h,i,j;if(a.call(Object.keys(c.languageList),d)<0)throw f=Object.keys(c.languageList),{message:"Unknown lang '"+d+"'. Allowed are:  '"+f.join(", ")+"'."};return c.currentLang=d,window.currentLang=d,a.call(c._lang_loaded,d)<0&&(b.loadRemote(c._remote_url+d+".json"),c._lang_loaded.push(d)),b.setCurrentLanguage(d),h=window.location.pathname,e=window.location.hash,g=h.split("/"),g[1]!==d&&(i=g[1],a.call(c._lang_loaded,i)<0)?g.splice(1,0,d):(j=g[1],a.call(c._lang_loaded,j)>=0&&(g[1]=d)),h=g.join("/"),"/"===h[h.length-1]?h=h.substring(0,h.length-1):void 0}}(this),this.setLanguageList=function(a){return function(b){return a.languageList=angular.copy(b)}}(this),this.setLanguageRemoteUrl=function(a){return function(b){return a._remote_url=angular.copy(b)}}(this),this.getCurrentLanguageName=function(b){return function(){var c;return c=b.currentLang,a.call(Object.keys(b.languageList),c)<0?"":b.languageList[b.currentLang]}}(this),this.detectLanguage=function(b){return function(){var c,d,e,f,g,h,i;if(h=window.location.pathname,g=h.split("/"),""!==g[1]&&(i=g[1],a.call(Object.keys(b.languageList),i)>=0))return void b.setCurrentLanguage(g[1]);for(e=window.navigator.languages||[window.navigator.language||window.navigator.userLanguage],c=0,f=e.length;f>c;c++)if(d=e[c],d=d.split("-")[0],a.call(Object.keys(b.languageList),d)>=0){b.setCurrentLanguage(d);break}}}(this),this}]).directive("langPicker",["$langPickerConf",function(a){return{restrict:"E",scope:{"default":"=?",ngDisabled:"=?"},controller:["$scope",function(b){return b.$langPickerConf=a,b["default"]?a.setCurrentLanguage(b["default"]):a.detectLanguage(),b.countryFlagCode=function(a){return"en"===a?"gb":a}}],template:'<div uib-dropdown="uib-dropdown" class="btn-group"><button type="button" uib-dropdown-toggle="uib-dropdown-toggle" ng-disabled="ngDisabled" class="btn btn-default"><flag country="{{countryFlagCode($langPickerConf.currentLang)}}"></flag>{{$langPickerConf.getCurrentLanguageName() || \'Language\'}}<span style="margin-left:3px;" class="caret"></span></button><ul uib-dropdown-menu="" role="menu"><li role="menuitem" ng-repeat="(lang_code, lang_name) in $langPickerConf.languageList" ng-click="$langPickerConf.setCurrentLanguage(lang_code)"><a href="javascript: void 0">   <flag country="{{countryFlagCode(lang_code)}}"></flag>{{lang_name}}</a><a href="/{{lang_code}}" style="display:none;"># For google search</a></li></ul></div>'}}])}).call(this);