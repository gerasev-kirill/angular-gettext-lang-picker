(function(){angular.module("ui.gettext.langPicker",["uiFlag","ui.bootstrap","ui.router"])}).call(this),function(){angular.module("ui.gettext.langPicker").directive("uiLangPicker",function(){return{restrict:"E",scope:{"default":"=?",ngDisabled:"=?"},controller:["$scope","$langPicker",function(a,b){return a.$langPicker=b,b.currentLang||b.detectLanguage(a["default"]),a.countryFlagCode=function(a){return b.languageCodeToCountryCodeMapping[a]?b.languageCodeToCountryCodeMapping[a]:a}}],template:'\n<div class="btn-group" uib-dropdown="uib-dropdown">\n  <button class="btn btn-default" type="button" uib-dropdown-toggle="uib-dropdown-toggle" ng-disabled="ngDisabled">\n    <flag country="{{countryFlagCode($langPicker.currentLang)}}"></flag>{{$langPicker.getCurrentLanguageName() || \'Language\'}}<span class="caret" style="margin-left:3px;"></span>\n  </button>\n  <ul uib-dropdown-menu="" role="menu">\n    <li role="menuitem" ng-repeat="(lang_code, lang_name) in $langPicker.languageList" ng-click="$langPicker.setCurrentLanguage(lang_code)" ng-class="{\'active\': lang_code==$langPicker.currentLang}"><a href="javascript: void 0">   \n        <flag country="{{countryFlagCode(lang_code)}}"></flag>{{lang_name}}</a></li>\n  </ul>\n</div>'}})}.call(this),angular.module("ui.gettext.langPicker").directive("uiLangPickerForNavbar",["$langPicker",function(a){return angular.element(document).find("head").prepend('<style type="text/css">\n    li.force-ng-hide[ui-lang-picker-for-navbar]{\n        display: none;\n    }\n</style>'),{restrict:"A",replace:!0,controller:["$scope","$attrs","$element","$langPicker","$state",function(a,b,c,d,e){return a.$state=e,a.$langPicker=d,a.attrs=b,d.currentLang||d.detectLanguage(),a.countryFlagCode=function(a){return d.languageCodeToCountryCodeMapping[a]?d.languageCodeToCountryCodeMapping[a]:a},a.$watch("$langPicker.languageList",function(a,b){var e;e=Object.keys(a||{}),e.length<=1?c.addClass("force-ng-hide"):c.removeClass("force-ng-hide"),d.currentLang&&!e.includes(d.currentLang)&&d.detectLanguage()},!0)}],template:'\n<li class="dropdown" uib-dropdown=""><a class="dropdown-toggle" uib-dropdown-toggle="" style="cursor:pointer;" ng-disabled="attrs.disabled">\n    <flag country="{{countryFlagCode($langPicker.currentLang)}}"></flag>{{$langPicker.getCurrentLanguageName() || \'Language\'}}<span class="caret" style="margin-left:3px;"></span></a>\n  <ul class="dropdown-menu" uib-dropdown-menu="" role="menu">\n    <li role="menuitem" ng-repeat="(lang_code, lang_name) in $langPicker.languageList" ng-click="$langPicker.setCurrentLanguage(lang_code)" ng-class="{\'active\': lang_code==$langPicker.currentLang}"><a href="javascript: void 0">   \n        <flag country="{{countryFlagCode(lang_code)}}"></flag>{{lang_name}}</a></li>\n  </ul>\n</li>'}}]);var indexOf=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};angular.module("ui.gettext.langPicker").service("$langPicker",["$injector","$rootScope","gettextCatalog",function(a,b,c){var d;return d=[],this._lang_loaded=[],this.languageList={},this.languageCodeToCountryCodeMapping={en:"gb",cs:"cz",da:"dk"},this.remoteCatalogUrl="",this.setIgnoreLoadRemoteLanguages=function(a){d=angular.copy(a)},this.currentLang="",this.setCurrentLanguage=function(e){return function(f){var g,h,i,j,k;if(indexOf.call(Object.keys(e.languageList),f)<0)throw h=Object.keys(e.languageList),{message:"Unknown lang '"+f+"'. Allowed are:  '"+h.join(", ")+"'."};j=angular.copy(e.currentLang),i=angular.copy(f),e.currentLang=f,indexOf.call(e._lang_loaded,f)<0&&indexOf.call(d,f)<0&&(c.loadRemote(e.remoteCatalogUrl+f+".json"),e._lang_loaded.push(f)),c.setCurrentLanguage(f),g=a.get("$state"),g.current.name&&(k=g.params||{},k.lang=f,g.go(g.current.name,k,{notify:!1,reload:!1}),b.$emit("$langPickerLangChanged",i,j))}}(this),this.setLanguageList=function(a){return function(b){return a.languageList=angular.copy(b)}}(this),this.setLanguageRemoteUrl=function(a){return function(b){return a.remoteCatalogUrl=angular.copy(b)}}(this),this.getCurrentLanguageName=function(a){return function(){var b;return b=a.currentLang,indexOf.call(Object.keys(a.languageList),b)<0?"":a.languageList[a.currentLang]}}(this),this.detectLanguage=function(b){return function(c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;for(e=a.get("$state"),d=a.get("$location"),f=Object.keys(b.languageList),s=d.url(),o=e.get(),g=0,l=o.length;g<l;g++)if(r=o[g],r.$$state&&(q=r.$$state(),n=q.url.exec(s)||q.url.exec(s.split("?")[0])||{},n.lang&&(p=n.lang,indexOf.call(f,p)>=0)))return b.setCurrentLanguage(n.lang);for(k=window.navigator.languages||[window.navigator.language||window.navigator.userLanguage],h=0,m=k.length;h<m;h++)if(i=k[h],i=i.split("-")[0],indexOf.call(f,i)>=0)return b.setCurrentLanguage(i);j=indexOf.call(f,c)>=0?c:f[0],b.setCurrentLanguage(j)}}(this),this}]),angular.module("ui.gettext.langPicker").config(["$provide","$stateProvider",function(a,b){return a.decorator("$state",["$delegate","$langPicker",function(a,b){var c,d,e;return e=a,c=e.go,e.go=function(a,d,e){return d=d||{},d.lang||(d.lang=b.currentLang),c(a,d,e)},d=e.href,e.href=function(a,b,c){var e;return b=b||{},e=d(a,b,c),!b.lang&&e&&(e=e.replace("//","/")),e},e}]),b.decorator("parent",function(a,b){return a.self.$$state=function(){return a},b(a)})}]);